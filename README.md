# ðŸŒŒ FlowLang VM

**A mystical anime-themed scripting language built in Rust**

FlowLang is an expressive, flow-centric programming language with dramatic anime-style error messages and mystical syntax. Code feels like casting magic spells!

## âœ¨ Features

- **Mystical Syntax**: Keywords like `cast Spell`, `in Stance`, `invoke Aura`, `enter Phase`
- **Essence Types**: `Ember` (numbers), `Silk` (strings), `Pulse` (booleans), `Constellation` (arrays)
- **Flow-Based Control**: Stances (conditionals), Auras (pattern matching), Phases (loops)
- **Dramatic Errors**: Anime-style error messages with colorful terminal output
- **Built-in Spells**: `whisper()`, `shout()`, `roar()`, `chant()` for different output styles
- **Async Rituals**: Support for asynchronous operations
- **Rich Standard Library**: Math, String, File I/O, JSON, HTTP, Time, CLI, Color, Crypto, OS modules
- **Combo Chains**: Pipeline operations with `>>` and `!!`

## ðŸš€ Installation

### Prerequisites

- Rust 1.70 or higher
- Cargo

### Build from Source

```bash
# Clone the repository
git clone <repository-url>
cd flowlang

# Build the project
cargo build --release

# The binary will be in target/release/flowlang
```

## ðŸ“– Usage

### Run a FlowLang Script

```bash
cargo run -- run examples/hello.flow
```

Or with the compiled binary:

```bash
./target/release/flowlang run examples/hello.flow
```

### Verbose Mode (Debugging)

Enable verbose output to see execution details:

```bash
./target/release/flowlang --verbose run examples/sample.flow
```

This shows:
- File reading progress
- Token count from lexer
- AST structure from parser
- Execution stages

### Developer Commands

#### View Lexer Tokens

```bash
./target/release/flowlang dev lex examples/hello.flow
```

Shows all tokens generated by the lexer with line and column numbers.

#### View Parser Output

```bash
./target/release/flowlang dev parse examples/hello.flow
```

Shows the parsed AST structure in a readable format.

#### View Detailed AST

```bash
./target/release/flowlang dev ast examples/hello.flow
```

Shows the complete AST with full debug output.

### Example Program

```flowlang
-- Hello World in FlowLang

cast Spell main() -> Hollow {
    shout("ðŸŒŒ Hello from FlowLang! ðŸŒŒ")
    whisper("The mystical energies awaken...")
}

main()
```

### More Examples

```flowlang
-- Demonstrating control flow

@experimental
cast Spell demo() -> Hollow {
    let power: Ember = 9200
    
    in Stance (power >> 9000) {
        roar("It'sâ€¦ OVER 9000!!!")
    }
    
    enter Phase i from 1 to 5 {
        chant("Chargingâ€¦ " + i)
    }
    
    let mood: Silk = "angry"
    
    invoke Aura mood {
        when "calm" -> whisper("Peaceful aura detected.")
        when "angry" -> shout("Hostile spirit unleashed!")
        otherwise -> whisper("Mystery emotionâ€¦")
    }
}

demo()
```

## ðŸŽ¨ Language Features

### Variables

```flowlang
let count = 10              -- Mutable essence
seal name = "Kaito"         -- Immutable essence
let heat: Ember = 88        -- With type annotation

-- Reassignment (only for 'let' variables)
count = count + 5
count = 20
```

### Functions (Spells)

```flowlang
cast Spell greet(Silk name) -> Hollow {
    shout("Greetings, " + name)
}

cast Spell multiply(Ember a, Ember b) -> Ember {
    return a * b
}

-- Inline spells (lambda-style)
let double = cast Spell x -> x * 2
let add = cast Spell (a, b) -> a + b
```

### Control Flow

#### Stances (If/Else)

```flowlang
in Stance (power >> 5000) {
    shout("Strong aura detected.")
}
shift Stance (power >> 9000) {
    roar("UNSTOPPABLE!")
}
abandon Stance {
    whisper("Not enough energy.")
}
```

#### Auras (Pattern Matching)

```flowlang
invoke Aura mood {
    when "calm" -> whisper("The waters are still.")
    when "angry" -> shout("THE STORM AWAKENS!")
    otherwise -> whisper("Unknown emotional signature.")
}
```

#### Phases (Loops)

```flowlang
-- Count loop
enter Phase i from 0 to 5 {
    chant("Step " + i)
}

-- For-each loop
let heroes = ["Goku", "Vegeta", "Gohan"]
enter Phase hero in heroes {
    shout("Hero: " + hero)
}

-- While loop
enter Phase until (enemy.defeated) {
    strike(enemy)
}

-- Infinite loop
enter Phase forever {
    drift()
}
```

### Operators

| Operation | Operator |
|-----------|----------|
| Addition | `+` |
| Subtraction | `-` |
| Multiplication | `*` |
| Division | `/` |
| Modulo | `%` |
| Equal | `is~` |
| Not Equal | `not~` |
| Greater | `>>` |
| Less | `<<` |
| Logical AND | `both!` |
| Logical OR | `either!` |
| Logical NOT | `negate!` |

### Built-in Functions

- `whisper(message)` - Quiet, dimmed output
- `shout(message)` - Normal, bold output
- `roar(message)` - Loud, emphasized output
- `chant(message)` - Cyan colored output

## ðŸŽ­ Error Messages

FlowLang features dramatic, anime-style error messages:

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âš¡ SYNTAX ERROR âš¡
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Location: 5:12

ðŸ’¬ The Spirit Speaks:
   "Expected ')' after condition"

   Your rune sequenceâ€¦ it's broken!
   Reform the pattern, before the flow collapses!
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

## ðŸ—ºï¸ Roadmap

- [x] Lexer with Unicode support
- [x] Parser with full AST
- [x] Interpreter with environment management
- [x] Control flow (Stances, Auras, Phases)
- [x] Functions and recursion
- [x] Anime-style error messages
- [x] Async rituals (rituals with await)
- [x] Type system with Essence Types
- [x] Standard library (10+ modules)
- [x] Arc migration for thread-safety
- [x] For-each loops (enter Phase item in collection)
- [ ] True parallel execution with perform
- [ ] Additional language features (more array methods, destructuring)
- [ ] Module system improvements
- [ ] REPL mode enhancements
- [ ] Bytecode compiler (future)

## ðŸ¤ Contributing

Contributions are welcome! Feel free to open issues or submit pull requests.

## ðŸ“œ License

MIT License - See LICENSE file for details

## ðŸŒŸ Acknowledgments

FlowLang is inspired by anime culture and designed to make programming feel more expressive and dramatic!

---

**May your code flow like mystical energy! âœ¨**
